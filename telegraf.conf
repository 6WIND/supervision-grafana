# 6WIND Telegraf Configuration
# edit and copy in /etc/telegraf

[global_tags]

[agent]
  interval = "5s"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = "0s"
  flush_interval = "10s"
  flush_jitter = "0s"
  precision = ""
  debug = false
  hostname = ""
  omit_hostname = false

##############
### INPUTS ###
##############

[[inputs.cpu]]
  percpu = true
  totalcpu = true
  fielddrop = ["time_*"]

[[inputs.disk]]
  ignore_fs = ["tmpfs", "devtmpfs"]

[[inputs.diskio]]

[[inputs.kernel]]

[[inputs.mem]]

[[inputs.processes]]

[[inputs.swap]]

[[inputs.system]]

# Dump the numbers of IPsec SAs synchronized in the kernel
[[inputs.exec]]
  commands = ["ip xfrm state count | awk '{print $3}'"]
  data_format = "value"
  data_type = "integer"
  name_suffix = "_ipsec"
  interval = "5s"

# Dump the fast path CPU usage per core
[[inputs.exec]]
  commands = ["fp-cpu-usage --json"]
  data_format = "json"
  name_suffix = "_fpcpuusage"
  interval = "5s"

# Dump the fast path statistics
[[inputs.exec]]
  commands = ["fp-cli stats-json"]
  data_format = "json"
  name_suffix = "_stats"
  interval = "5s"

# Physical interfaces that you want to monitor
[[inputs.net]]
  interfaces = ["enp4s0f0", "enp4s0f1", "enp6s0f0", "enp6s0f1", "enp5s0f0"]  ## adapt the monitored interfaces

###############
### OUTPUTS ###
###############

[[outputs.influxdb]]
  urls = ["http://10.81.1.37:8086"] ## adapt the IP address to your InfluxDB server
  database = "turbodb"              ## adapt the database name
  username = "root"                 ## adapt the database username
  password = "root"                 ## adapt the database password
  write_consistency = "any"
  timeout = "5s"

